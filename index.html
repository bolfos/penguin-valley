<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>Penguin Farmer</title>

<style>
*{box-sizing:border-box}
body{
 margin:0;
 font-family:'Trebuchet MS',Arial;
 background:linear-gradient(#b3e5fc,#e0f7fa);
}
.hidden{display:none}
button{cursor:pointer;border:none}

/* TOP */
#topbar{
 height:56px;background:#0d47a1;color:white;
 display:flex;align-items:center;justify-content:space-between;
 padding:0 16px;font-size:18px
}

/* LAYOUT */
#layout{display:flex;height:calc(100vh - 56px)}
#sidebar{
 width:220px;background:#bbdefb;padding:12px
}
.sidebtn{
 width:100%;margin-bottom:10px;padding:14px;
 border-radius:14px;background:#1976d2;
 color:white;font-size:16px
}
#content{flex:1;padding:16px}

/* FARM */
#farm{
 display:grid;
 grid-template-columns:repeat(6,90px);
 gap:12px;justify-content:center
}
.tile{
 width:90px;height:90px;border-radius:16px;
 display:flex;align-items:center;justify-content:center;
 font-size:26px;
 box-shadow:0 4px 0 rgba(0,0,0,.25)
}
.free{background:#a5d6a7}
.frozen{background:#cfd8dc}
.growing{background:#ffe082}
.ready{background:#81c784}

/* MAP */
#map{
 display:grid;
 grid-template-columns:repeat(3,220px);
 gap:20px;justify-content:center
}
.zone{
 background:white;border-radius:18px;padding:20px;
 text-align:center;
 box-shadow:0 6px 0 rgba(0,0,0,.25)
}
.locked{opacity:.5}
.zone button{
 margin-top:10px;padding:10px 16px;
 background:#1976d2;color:white;border-radius:12px
}

/* MISSIONS */
#missionBox{
 background:white;
 padding:16px;
 border-radius:16px;
 max-width:420px;
 box-shadow:0 6px 0 rgba(0,0,0,.25)
}

/* LOGIN */
#login{
 position:fixed;inset:0;
 display:flex;align-items:center;justify-content:center;
 background:linear-gradient(#90caf9,#e3f2fd)
}
#loginBox{
 background:white;padding:20px;width:300px;
 border-radius:16px
}

/* MSG */
#msg{
 position:fixed;bottom:16px;left:50%;
 transform:translateX(-50%);
 background:#263238;color:white;
 padding:10px 18px;border-radius:20px
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
 <div id="loginBox">
  <h2>ğŸ§ Penguin Farmer</h2>
  <input id="email" placeholder="Email" style="width:100%;margin-bottom:10px;padding:8px">
  <input id="pass" type="password" placeholder="ParolÄƒ" style="width:100%;margin-bottom:10px;padding:8px">
  <button onclick="loginUser()" style="width:100%;padding:10px;background:#1976d2;color:white;border-radius:12px">
   IntrÄƒ / CreeazÄƒ cont
  </button>
 </div>
</div>

<!-- GAME -->
<div id="game" class="hidden">
<div id="topbar">
 <div>ğŸ§ Penguin Farmer</div>
 <div id="stats"></div>
</div>

<div id="layout">
<div id="sidebar">
 <button class="sidebtn" onclick="show('farmView')">ğŸŒ¾ FermÄƒ</button>
 <button class="sidebtn" onclick="show('mapView')">ğŸ—ºï¸ HartÄƒ</button>
 <button class="sidebtn" onclick="show('missionView')">ğŸ“œ Misiuni</button>
</div>

<div id="content">

<!-- FARM -->
<div id="farmView">
 <h2>Ferma ta</h2>
 <button onclick="selectCrop('carrot')">ğŸ¥•</button>
 <button onclick="selectCrop('cabbage')">ğŸ¥¬</button>
 <button onclick="selectCrop('flower')">ğŸŒ¼</button>
 <div id="farm"></div>
</div>

<!-- MAP -->
<div id="mapView" class="hidden">
 <h2>Harta Lumii</h2>
 <div id="map"></div>
</div>

<!-- MISSIONS -->
<div id="missionView" class="hidden">
 <h2>Misiune curentÄƒ</h2>
 <div id="missionBox"></div>
</div>

</div>
</div>
</div>

<div id="msg" class="hidden"></div>

<!-- FIREBASE MODULE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged }
 from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc }
 from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-analytics.js";

/* CONFIG â€“ EXACT AL TÄ‚U */
const firebaseConfig={
 apiKey:"AIzaSyBSzq_-8WZ7xSqPqUd1nr_p4mNoHdFaZ3w",
 authDomain:"penguin-valley-9d490.firebaseapp.com",
 projectId:"penguin-valley-9d490",
 storageBucket:"penguin-valley-9d490.firebasestorage.app",
 messagingSenderId:"399240782858",
 appId:"1:399240782858:web:1d79355154b8be1ed3ebf3",
 measurementId:"G-89JS2RLYZD"
};

const app=initializeApp(firebaseConfig);
getAnalytics(app);
const auth=getAuth();
const db=getFirestore();

/* GAME STATE */
let uid;
let money=20,level=1;
let FREE=[7,8,13,14],tiles={},selectedCrop="carrot";
let unlockedZones=["farm"];
let missionIndex=0;

/* DATA */
const crops={
 carrot:{emoji:"ğŸ¥•",time:8000,profit:5,cost:1},
 cabbage:{emoji:"ğŸ¥¬",time:15000,profit:15,cost:3},
 flower:{emoji:"ğŸŒ¼",time:25000,profit:40,cost:5}
};

const missions=[
 {text:"PlanteazÄƒ 3 morcovi",check:()=>count("carrot")>=3,reward:20},
 {text:"StrÃ¢nge 50 bani",check:()=>money>=50,reward:30},
 {text:"PlanteazÄƒ 2 flori",check:()=>count("flower")>=2,reward:50}
];

/* AUTH */
window.loginUser=()=>{
 signInWithEmailAndPassword(auth,email.value,pass.value)
 .catch(()=>createUserWithEmailAndPassword(auth,email.value,pass.value));
};

onAuthStateChanged(auth,u=>{
 if(!u)return;
 uid=u.uid;
 login.classList.add("hidden");
 game.classList.remove("hidden");
 load();start();
});

/* SAVE / LOAD */
async function save(){
 await setDoc(doc(db,"users",uid),{
  money,level,FREE,tiles,unlockedZones,missionIndex
 });
}
async function load(){
 const d=await getDoc(doc(db,"users",uid));
 if(d.exists())Object.assign(window,d.data());
}

/* UI */
function msg(t){
 msgBox.textContent=t;
 msgBox.classList.remove("hidden");
 setTimeout(()=>msgBox.classList.add("hidden"),2000);
}
function update(){
 stats.textContent=`ğŸ’° ${money} | â­ ${level}`;
 save();
}
window.show=id=>{
 ["farmView","mapView","missionView"].forEach(v=>document.getElementById(v).classList.add("hidden"));
 document.getElementById(id).classList.remove("hidden");
 if(id==="missionView")drawMission();
};

/* MISSIONS */
function drawMission(){
 const m=missions[missionIndex];
 if(!m){missionBox.innerHTML="ğŸ† Toate misiunile terminate!";return;}
 missionBox.innerHTML=`
  <p>${m.text}</p>
  <button onclick="checkMission()">FinalizeazÄƒ</button>
 `;
}
window.checkMission=()=>{
 const m=missions[missionIndex];
 if(!m.check())return alert("Nu e gata!");
 money+=m.reward;
 missionIndex++;
 level++;
 update();drawMission();
};

/* FARM */
function count(t){return Object.values(tiles).filter(x=>x.t===t).length}
function drawFarm(){
 farm.innerHTML="";
 for(let i=0;i<36;i++){
  const d=document.createElement("div");
  d.className="tile";
  if(!FREE.includes(i)){
   d.classList.add("frozen");d.textContent="â„ï¸";
   d.onclick=()=>money<20?0:(money-=20,FREE.push(i),update(),drawFarm());
  }else if(!tiles[i]){
   d.classList.add("free");d.textContent="â•";
   d.onclick=()=>plant(i);
  }else{
   const c=crops[tiles[i].t];
   const r=c.time-(Date.now()-tiles[i].d);
   d.classList.add(r<=0?"ready":"growing");
   d.textContent=r<=0?c.emoji:"â³";
   if(r<=0)d.onclick=()=>harvest(i);
  }
  farm.appendChild(d);
 }
}
window.selectCrop=c=>selectedCrop=c;
function plant(i){
 const c=crops[selectedCrop];
 if(money<c.cost)return;
 money-=c.cost;tiles[i]={t:selectedCrop,d:Date.now()};
 update();drawFarm();
}
function harvest(i){
 money+=crops[tiles[i].t].profit;
 delete tiles[i];
 update();drawFarm();
}

/* START */
function start(){
 drawFarm();update();
 setInterval(drawFarm,1000);
}
</script>

</body>
</html>
