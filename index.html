<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>Penguin Farmer</title>

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Verdana;background:linear-gradient(#b3e5fc,#e0f7fa)}
.hidden{display:none}
button{cursor:pointer;border:none}

/* TOP */
#topbar{
 height:56px;background:#0d47a1;color:white;
 display:flex;align-items:center;justify-content:space-between;padding:0 15px
}

/* LAYOUT */
#layout{display:flex;height:calc(100vh - 56px)}
#sidebar{
 width:220px;background:#bbdefb;padding:10px
}
.sidebtn{
 width:100%;margin-bottom:10px;padding:14px;
 border-radius:12px;background:#1976d2;color:white;font-size:16px
}
#content{flex:1;padding:15px}

/* FARM */
#farm{
 display:grid;grid-template-columns:repeat(6,80px);
 gap:10px;justify-content:center
}
.tile{
 width:80px;height:80px;border-radius:14px;
 display:flex;align-items:center;justify-content:center;
 font-size:24px;background:#e0e0e0
}
.free{background:#a5d6a7}
.frozen{background:#cfd8dc}

/* MAP */
#map{
 display:grid;
 grid-template-columns:repeat(3,220px);
 gap:20px;justify-content:center;margin-top:30px
}
.zone{
 background:white;border-radius:16px;padding:20px;
 text-align:center;box-shadow:0 6px 0 rgba(0,0,0,.2)
}
.locked{opacity:.5}
.zone button{
 margin-top:10px;padding:10px 16px;
 background:#1976d2;color:white;border-radius:10px
}

/* LOGIN */
#login{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
background:linear-gradient(#90caf9,#e3f2fd)}
#loginBox{
 background:white;padding:20px;width:300px;border-radius:14px
}

/* MSG */
#msg{
 position:fixed;bottom:15px;left:50%;
 transform:translateX(-50%);
 background:#263238;color:white;
 padding:10px 16px;border-radius:20px
}
</style>
</head>

<body>

<div id="login">
 <div id="loginBox">
  <h2>ğŸ§ Penguin Farmer</h2>
  <input id="email" placeholder="Email" style="width:100%;margin-bottom:10px;padding:8px">
  <input id="pass" type="password" placeholder="ParolÄƒ" style="width:100%;margin-bottom:10px;padding:8px">
  <button onclick="auth()" style="width:100%;padding:10px;background:#1976d2;color:white;border-radius:10px">
   IntrÄƒ / CreeazÄƒ cont
  </button>
 </div>
</div>

<div id="game" class="hidden">
<div id="topbar">
 <div>ğŸ§ Penguin Farmer</div>
 <div id="stats"></div>
</div>

<div id="layout">
<div id="sidebar">
 <button class="sidebtn" onclick="show('farmView')">ğŸŒ¾ FermÄƒ</button>
 <button class="sidebtn" onclick="show('mapView')">ğŸ—ºï¸ HartÄƒ</button>
</div>

<div id="content">

<!-- FARM -->
<div id="farmView">
 <h2>Ferma ta</h2>
 <button onclick="selectCrop('carrot')">ğŸ¥•</button>
 <button onclick="selectCrop('cabbage')">ğŸ¥¬</button>
 <button onclick="selectCrop('flower')">ğŸŒ¼</button>
 <div id="farm"></div>
</div>

<!-- MAP -->
<div id="mapView" class="hidden">
 <h2>Harta Lumii</h2>
 <div id="map"></div>
</div>

</div>
</div>
</div>

<div id="msg" class="hidden"></div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
/* FIREBASE CONFIG */
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyBSzq_-8WZ7xSqPqUd1nr_p4mNoHdFaZ3w",
    authDomain: "penguin-valley-9d490.firebaseapp.com",
    projectId: "penguin-valley-9d490",
    storageBucket: "penguin-valley-9d490.firebasestorage.app",
    messagingSenderId: "399240782858",
    appId: "1:399240782858:web:1d79355154b8be1ed3ebf3",
    measurementId: "G-89JS2RLYZD"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
/* MSG */
function msg(t){
 const m=document.getElementById("msg");
 m.textContent=t;m.classList.remove("hidden");
 setTimeout(()=>m.classList.add("hidden"),2000);
}

/* AUTH */
function auth(){
 authF.signInWithEmailAndPassword(email.value,pass.value)
 .catch(()=>authF.createUserWithEmailAndPassword(email.value,pass.value));
}
authF.onAuthStateChanged(u=>{
 if(!u)return;
 user=u.uid;
 login.classList.add("hidden");
 game.classList.remove("hidden");
 load();start();
});
/* GAME DATA */
let user,money=20,level=1;
let FREE=[7,8,13,14],tiles={},selectedCrop="carrot";
let unlockedZones=["farm"];

const crops={
 carrot:{emoji:"ğŸ¥•",time:8000,profit:5,cost:1},
 cabbage:{emoji:"ğŸ¥¬",time:15000,profit:15,cost:3},
 flower:{emoji:"ğŸŒ¼",time:25000,profit:40,cost:5}
};

const zones=[
 {id:"farm",name:"ğŸŒ¾ Ferma",cost:0},
 {id:"city",name:"ğŸ™ï¸ South Poleville",cost:50},
 {id:"north",name:"â„ï¸ Nord ÃngheÈ›at",cost:150},
 {id:"jungle",name:"ğŸŒ´ Jungle",cost:300},
 {id:"desert",name:"ğŸœï¸ DeÈ™ert",cost:500}
];

/* SAVE / LOAD */
function save(){
 if(!user) return; // SiguranÈ›Äƒ: salveazÄƒ doar dacÄƒ e logat
 db.collection("users").doc(user).set({
  money, level, FREE, tiles, unlockedZones
 }, { merge: true }); // <--- Aceasta este modificarea recomandatÄƒ
}

function load(){
 if(!user) return;
 db.collection("users").doc(user).get().then(d=>{
  if(!d.exists) return;
  Object.assign(window, d.data());
  // Aici poÈ›i adÄƒuga o funcÈ›ie de update vizual (ex: updateUI())
 });
}


/* UI */
function update(){
 stats.textContent=`ğŸ’° ${money} | â­ ${level}`;
 save();
}
function show(id){
 ["farmView","mapView"].forEach(v=>document.getElementById(v).classList.add("hidden"));
 document.getElementById(id).classList.remove("hidden");
 if(id==="mapView")drawMap();
}

/* MAP */
function drawMap(){
 map.innerHTML="";
 zones.forEach(z=>{
  const d=document.createElement("div");
  d.className="zone";
  const unlocked=unlockedZones.includes(z.id);
  if(!unlocked)d.classList.add("locked");
  d.innerHTML=`<h3>${z.name}</h3>
   <p>${unlocked?"DeblocatÄƒ":"Cost: "+z.cost}</p>`;
  const b=document.createElement("button");
  b.textContent=unlocked?"IntrÄƒ":"DeblocheazÄƒ";
  b.onclick=()=>unlockZone(z);
  d.appendChild(b);
  map.appendChild(d);
 });
}
function unlockZone(z){
 if(unlockedZones.includes(z.id))return msg("Zona activÄƒ");
 if(money<z.cost)return msg("Bani insuficienÈ›i");
 money-=z.cost;
 unlockedZones.push(z.id);
 update();drawMap();
}

/* FARM */
function drawFarm(){
 farm.innerHTML="";
 for(let i=0;i<36;i++){
  const t=document.createElement("div");
  t.className="tile";
  if(!FREE.includes(i)){
   t.classList.add("frozen");
   t.textContent="â„ï¸";
   t.onclick=()=>money<20?msg("Nu ai bani"):(
    money-=20,FREE.push(i),update(),drawFarm()
   );
  }else if(!tiles[i]){
   t.classList.add("free");
   t.onclick=()=>plant(i);
  }else{
   const c=crops[tiles[i].t];
   const r=c.time-(Date.now()-tiles[i].d);
   t.textContent=r<=0?c.emoji:"â³";
   if(r<=0)t.onclick=()=>harvest(i);
  }
  farm.appendChild(t);
 }
}

/* ACTIONS */
function selectCrop(c){selectedCrop=c}
function plant(i){
 const c=crops[selectedCrop];
 if(money<c.cost)return msg("Bani insuficienÈ›i");
 money-=c.cost;tiles[i]={t:selectedCrop,d:Date.now()};
 update();drawFarm();
}
function harvest(i){
 money+=crops[tiles[i].t].profit;
 delete tiles[i];
 if(money>100)level=2;
 update();drawFarm();
}

function start(){
 drawFarm();update();
 setInterval(drawFarm,1000);
}
</script>

</body>
</html>


