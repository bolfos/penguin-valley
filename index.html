<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>Penguin Farmer</title>
<style>
body{margin:0;font-family:Arial;background:#b3e5fc}
#top{background:#0d47a1;color:white;padding:10px;display:flex;justify-content:space-between}
#layout{display:flex;height:calc(100vh - 50px)}
#menu{width:200px;background:#bbdefb;padding:10px}
#menu button{width:100%;margin-bottom:8px;padding:10px;border:none;border-radius:12px;background:#1976d2;color:white}
#content{flex:1;padding:12px}
.hidden{display:none}
#farm{display:grid;grid-template-columns:repeat(10,70px);gap:8px;justify-content:center}
.tile{width:70px;height:70px;border-radius:14px;display:flex;align-items:center;justify-content:center;background:#cfd8dc;position:relative}
.free{background:#a5d6a7}
.locked{background:#90a4ae}
.time{position:absolute;bottom:4px;right:4px;font-size:11px;background:rgba(0,0,0,.6);color:white;padding:2px 6px;border-radius:6px}
.marketItem{background:white;padding:10px;border-radius:12px;margin-bottom:8px;display:flex;justify-content:space-between}
</style>
</head>

<body>

<div id="top">
 <div>ğŸ§ Penguin Farmer</div>
 <div id="stats"></div>
</div>

<div id="layout">
 <div id="menu">
  <button onclick="show('farmView')">ğŸŒ¾ FermÄƒ</button>
  <button onclick="show('marketView')">ğŸª Market</button>
 </div>

 <div id="content">
  <div id="farmView">
   <button onclick="selectCrop('carrot')">ğŸ¥•</button>
   <button onclick="selectCrop('cabbage')">ğŸ¥¬</button>
   <button onclick="selectCrop('flower')">ğŸŒ¼</button>
   <div id="farm"></div>
  </div>

  <div id="marketView" class="hidden">
   <h2>Market</h2>
   <div id="market"></div>
  </div>
 </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAuth, signInAnonymously, onAuthStateChanged }
 from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc }
 from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

/* ğŸ”¥ FIREBASE CONFIG â€“ AL TÄ‚U */
const firebaseConfig={
 apiKey:"AIzaSyBSzq_-8WZ7xSqPqUd1nr_p4mNoHdFaZ3w",
 authDomain:"penguin-valley-9d490.firebaseapp.com",
 projectId:"penguin-valley-9d490",
 appId:"1:399240782858:web:1d79355154b8be1ed3ebf3"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth();
const db=getFirestore();

/* GAME STATE */
let uid=null;
let money=20;
let selectedCrop="carrot";
let tiles={},inventory={carrot:0,cabbage:0,flower:0};
let unlocked=20;

const crops={
 carrot:{time:4000,cost:1,price:4},
 cabbage:{time:8000,cost:3,price:10},
 flower:{time:14000,cost:5,price:25}
};

/* AUTH */
signInAnonymously(auth);
onAuthStateChanged(auth,async user=>{
 if(!user)return;
 uid=user.uid;
 await loadGame();
 startGame();
});

/* FIRESTORE */
async function loadGame(){
 const ref=doc(db,"players",uid);
 const snap=await getDoc(ref);
 if(snap.exists()){
  const d=snap.data();
  money=d.money;tiles=d.tiles||{};
  inventory=d.inventory||inventory;
  unlocked=d.unlocked||unlocked;
 }else{
  await saveGame();
 }
}
async function saveGame(){
 await setDoc(doc(db,"players",uid),{
  money,tiles,inventory,unlocked
 });
}

/* UI */
function show(id){
 farmView.classList.add("hidden");
 marketView.classList.add("hidden");
 document.getElementById(id).classList.remove("hidden");
}
function statsUpdate(){stats.textContent=`ğŸ’° ${money}`}

/* FARM */
function drawFarm(){
 farm.innerHTML="";
 for(let i=0;i<100;i++){
  const t=document.createElement("div");t.className="tile";
  if(i>=unlocked){
   t.classList.add("locked");t.textContent="â„ï¸";
   t.onclick=()=>unlock();
  }else if(!tiles[i]){
   t.classList.add("free");t.textContent="+";
   t.onclick=()=>plant(i);
  }else{
   const c=crops[tiles[i].t];
   const r=c.time-(Date.now()-tiles[i].d);
   t.textContent=r<=0?"âœ”":"â³";
   if(r<=0)t.onclick=()=>harvest(i);
  }
  farm.appendChild(t);
 }
}

function unlock(){if(money<10)return;money-=10;unlocked++;statsUpdate();drawFarm();saveGame();}
function selectCrop(c){selectedCrop=c}
function plant(i){
 const c=crops[selectedCrop];
 if(money<c.cost)return;
 money-=c.cost;
 tiles[i]={t:selectedCrop,d:Date.now()};
 statsUpdate();drawFarm();saveGame();
}
function harvest(i){
 inventory[tiles[i].t]++;
 delete tiles[i];
 statsUpdate();drawFarm();drawMarket();saveGame();
}

/* MARKET */
function drawMarket(){
 market.innerHTML="";
 for(const k in inventory){
  market.innerHTML+=`
   <div class="marketItem">${k} x${inventory[k]}
   <button onclick="sell('${k}')">Vinde ${crops[k].price}ğŸ’°</button></div>`;
 }
}
window.sell=k=>{
 if(inventory[k]<=0)return;
 inventory[k]--;money+=crops[k].price;
 statsUpdate();drawMarket();saveGame();
};

/* START */
function startGame(){
 statsUpdate();drawFarm();drawMarket();
 setInterval(drawFarm,1000);
}
</script>

</body>
</html>
