<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>Penguin Farmer</title>

<style>
*{box-sizing:border-box}
body{
 margin:0;
 font-family:Arial,Helvetica,sans-serif;
 background:linear-gradient(#b3e5fc,#e0f7fa)
}
button{cursor:pointer}
.hidden{display:none}

/* TOP */
#topbar{
 height:50px;
 background:#0d47a1;
 color:white;
 display:flex;
 align-items:center;
 justify-content:space-between;
 padding:0 16px;
}

/* LAYOUT */
#layout{display:flex;height:calc(100vh - 50px)}
#sidebar{
 width:210px;
 background:#bbdefb;
 padding:10px;
}
.sidebtn{
 width:100%;
 padding:12px;
 margin-bottom:8px;
 border-radius:12px;
 background:#1976d2;
 color:white;
 border:none;
}

/* CONTENT */
#content{flex:1;padding:16px}

/* FARM */
#farm{
 display:grid;
 grid-template-columns:repeat(8,80px);
 gap:10px;
 justify-content:center;
}
.tile{
 width:80px;height:80px;
 border-radius:14px;
 display:flex;
 align-items:center;
 justify-content:center;
 font-size:26px;
 background:#cfd8dc;
}
.free{background:#a5d6a7}
.growing{background:#ffe082}
.ready{background:#81c784}

/* PANELS */
.panel{
 background:white;
 padding:16px;
 border-radius:16px;
 max-width:500px;
}
.listItem{
 background:#f5f5f5;
 padding:10px;
 margin-bottom:8px;
 border-radius:12px;
 display:flex;
 justify-content:space-between;
}
</style>
</head>

<body>

<div id="game">
 <div id="topbar">
  <div>ğŸ§ Penguin Farmer</div>
  <div id="stats"></div>
 </div>

 <div id="layout">
  <div id="sidebar">
   <button class="sidebtn" onclick="show('farmView')">ğŸŒ¾ FermÄƒ</button>
   <button class="sidebtn" onclick="show('missionView')">ğŸ“œ Misiuni</button>
   <button class="sidebtn" onclick="show('buildView')">ğŸ—ï¸ ClÄƒdiri</button>
  </div>

  <div id="content">
   <div id="farmView">
    <h2>Harta fermei</h2>
    <button onclick="selectCrop('carrot')">ğŸ¥•</button>
    <button onclick="selectCrop('cabbage')">ğŸ¥¬</button>
    <button onclick="selectCrop('flower')">ğŸŒ¼</button>
    <div id="farm"></div>
   </div>

   <div id="missionView" class="hidden panel">
    <h2>Misiune</h2>
    <div id="missionBox"></div>
   </div>

   <div id="buildView" class="hidden panel">
    <h2>ClÄƒdiri</h2>
    <div id="buildings"></div>
   </div>
  </div>
 </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAuth, signInAnonymously, onAuthStateChanged }
 from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";

const firebaseConfig={
 apiKey:"AIzaSyBSzq_-8WZ7xSqPqUd1nr_p4mNoHdFaZ3w",
 authDomain:"penguin-valley-9d490.firebaseapp.com",
 projectId:"penguin-valley-9d490",
 appId:"1:399240782858:web:1d79355154b8be1ed3ebf3"
};
const app=initializeApp(firebaseConfig);
const auth=getAuth();

/* AUTO LOGIN ANONIM */
signInAnonymously(auth);
onAuthStateChanged(auth,u=>{
 if(u) initGame();
});

/* GAME STATE */
let money=20;
let selectedCrop="carrot";
let tiles={};
let inventory={carrot:0,cabbage:0,flower:0};
let level=1;

const FREE=[18,19,20,26,27,28];
const crops={
 carrot:{emoji:"ğŸ¥•",time:5000,profit:5,cost:1},
 cabbage:{emoji:"ğŸ¥¬",time:10000,profit:15,cost:3},
 flower:{emoji:"ğŸŒ¼",time:20000,profit:40,cost:5}
};

/* MISSIONS */
const missions=[
 {text:"PlanteazÄƒ 3 morcovi",check:()=>inventory.carrot>=3,reward:20},
 {text:"CÃ¢È™tigÄƒ 50 ğŸ’°",check:()=>money>=50,reward:30},
 {text:"PlanteazÄƒ 2 flori",check:()=>inventory.flower>=2,reward:50}
];
let missionIndex=0;

/* UI */
function show(id){
 ["farmView","missionView","buildView"].forEach(v=>{
  document.getElementById(v).classList.add("hidden");
 });
 document.getElementById(id).classList.remove("hidden");
}

function updateStats(){
 stats.textContent=`ğŸ’° ${money} | â­ ${level}`;
}

/* FARM */
function drawFarm(){
 farm.innerHTML="";
 for(let i=0;i<64;i++){
  const d=document.createElement("div");
  d.className="tile";
  if(!FREE.includes(i)){
   d.textContent="â„ï¸";
  }else if(!tiles[i]){
   d.classList.add("free");
   d.textContent="â•";
   d.onclick=()=>plant(i);
  }else{
   const c=crops[tiles[i].t];
   const r=c.time-(Date.now()-tiles[i].d);
   d.classList.add(r<=0?"ready":"growing");
   d.textContent=r<=0?c.emoji:"â³";
   if(r<=0)d.onclick=()=>harvest(i);
  }
  farm.appendChild(d);
 }
}
function selectCrop(c){selectedCrop=c;}
function plant(i){
 const c=crops[selectedCrop];
 if(money<c.cost)return;
 money-=c.cost;
 tiles[i]={t:selectedCrop,d:Date.now()};
 updateStats();drawFarm();
}
function harvest(i){
 inventory[tiles[i].t]++;
 delete tiles[i];
 updateStats();drawFarm();drawMission();
}

/* MISSIONS */
function drawMission(){
 const m=missions[missionIndex];
 missionBox.innerHTML=m?
 `<p>${m.text}</p><button onclick="finishMission()">FinalizeazÄƒ</button>`:
 "ğŸ† Toate misiunile terminate!";
}
window.finishMission=()=>{
 const m=missions[missionIndex];
 if(!m.check())return alert("Nu e gata");
 money+=m.reward;
 level++;missionIndex++;
 updateStats();drawMission();
};

/* BUILDINGS */
const buildingData={
 barn:{name:"Depozit",cost:30},
 mill:{name:"MoarÄƒ",cost:50}
};
let buildings={barn:0,mill:0};
function drawBuildings(){
 buildings.innerHTML="";
 for(const k in buildingData){
  buildings.innerHTML+=`
   <div class="listItem">
    ${buildingData[k].name} lvl ${buildings[k]}
    <button onclick="upgrade('${k}')">Upgrade</button>
   </div>`;
 }
}
window.upgrade=k=>{
 const c=buildingData[k].cost;
 if(money<c)return;
 money-=c;buildings[k]++;updateStats();drawBuildings();
};

/* START */
function initGame(){
 updateStats();
 drawFarm();
 drawMission();
 drawBuildings();
 setInterval(drawFarm,1000);
}
</script>

</body>
</html>
