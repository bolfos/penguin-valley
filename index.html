<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>Penguin Farmer</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(#cceeff, #ffffff);
}

#topbar {
  background: #4fc3f7;
  padding: 10px 20px;
  display: flex;
  justify-content: space-between;
  color: white;
  font-size: 18px;
}

#layout {
  display: flex;
  height: calc(100vh - 50px);
}

#sidebar {
  width: 220px;
  background: #e1f5fe;
  padding: 10px;
}

#sidebar h3 {
  margin-top: 15px;
}

#sidebar button {
  width: 100%;
  margin-bottom: 6px;
  padding: 8px;
  cursor: pointer;
}

#game {
  flex: 1;
  padding: 20px;
}

#farm {
  display: grid;
  grid-template-columns: repeat(6, 70px);
  gap: 8px;
  justify-content: center;
}

.tile {
  width: 70px;
  height: 70px;
  border-radius: 10px;
  background: #b3e5fc;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 22px;
}

.tile.free { background: #a5d6a7; }
.tile.frozen { background: #cfd8dc; }

.hidden { display: none; }

.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background: white;
  padding: 20px;
  border-radius: 10px;
  min-width: 250px;
}

.map button {
  padding: 15px;
  margin: 10px;
  font-size: 18px;
}
</style>
</head>

<body>

<header id="topbar">
  <div>ğŸ§ Penguin Farmer</div>
  <div>
    <span id="money">ğŸ’° 10</span>
    <span id="level">â­ Lv 1</span>
    <span id="zone">ğŸ“ Ferma</span>
  </div>
</header>

<div id="layout">

<aside id="sidebar">
  <h3>ğŸŒ Navigare</h3>
  <button onclick="goTo('farm')">ğŸŒ¾ Ferma</button>
  <button onclick="goTo('map')">ğŸ—ºï¸ HartÄƒ</button>
  <button onclick="goTo('city')">ğŸ˜ï¸ OraÈ™</button>

  <h3>ğŸŒ± Culturi</h3>
  <button onclick="selectCrop('carrot')">ğŸ¥• Morcov</button>
  <button onclick="selectCrop('cabbage')">ğŸ¥¬ VarzÄƒ</button>
  <button onclick="selectCrop('flower')">ğŸŒ¼ Floare</button>

  <h3>ğŸ¡ DecoraÈ›iuni</h3>
  <button onclick="selectDeco('road')">ğŸŸ« Drum</button>
  <button onclick="selectDeco('pond')">ğŸ’§ Iaz</button>
</aside>

<main id="game">

<section id="farmView">
  <h2>ğŸŒ¾ Ferma ta</h2>
  <div id="farm"></div>
</section>

<section id="mapView" class="hidden">
  <h2>ğŸ—ºï¸ Harta Polarului</h2>
  <div class="map">
    <button onclick="goTo('farm')">ğŸŒ¾ Ferma</button>
    <button onclick="goTo('city')">ğŸ˜ï¸ South Poleville</button>
    <div style="font-size:40px">ğŸ§ ğŸ¦­ ğŸ¦Š</div>
  </div>
</section>

<section id="cityView" class="hidden">
  <h2>ğŸ˜ï¸ South Poleville</h2>
  <button onclick="openMarket()">ğŸª Market</button>
  <button onclick="openQuests()">ğŸ“œ Misiuni</button>
  <button onclick="buyDog()">ğŸ• CÃ¢ine (50)</button>
  <button onclick="buySnowmobile()">ğŸ›· Snowmobile (100)</button>
</section>

</main>
</div>

<div id="market" class="modal hidden">
  <div class="modal-content">
    <h2>ğŸª Market</h2>
    <div id="inventory"></div>
    <button onclick="closeMarket()">Ãnchide</button>
  </div>
</div>

<div id="quests" class="modal hidden">
  <div class="modal-content">
    <h2>ğŸ“œ Misiuni</h2>
    <div id="questList"></div>
    <button onclick="closeQuests()">Ãnchide</button>
  </div>
</div>

<script>
/* === GAME LOGIC === */
const GRID = 6;
const farm = document.getElementById("farm");
const moneyEl = document.getElementById("money");
const levelEl = document.getElementById("level");

let money = Number(localStorage.getItem("money")) || 10;
let level = Number(localStorage.getItem("level")) || 1;
let xp = Number(localStorage.getItem("xp")) || 0;
let FREE_TILES = JSON.parse(localStorage.getItem("freeTiles")) || [7,8,13,14];
let tiles = JSON.parse(localStorage.getItem("tiles")) || {};
let penguinPos = Number(localStorage.getItem("penguinPos")) || 7;
let inventory = JSON.parse(localStorage.getItem("inventory")) || {};
let decorationsPlaced = JSON.parse(localStorage.getItem("decorations")) || {};
let dogs = Number(localStorage.getItem("dogs")) || 0;
let vehicle = localStorage.getItem("vehicle") || "sled";
let currentZone = localStorage.getItem("zone") || "farm";

const crops = {
  carrot:{emoji:"ğŸ¥•",time:60000,profit:5,cost:1,xp:5},
  cabbage:{emoji:"ğŸ¥¬",time:180000,profit:15,cost:3,xp:15},
  flower:{emoji:"ğŸŒ¼",time:360000,profit:40,cost:5,xp:30}
};

const decorations = {
  road:{emoji:"ğŸŸ«",cost:5},
  pond:{emoji:"ğŸ’§",cost:10}
};

let selectedCrop="carrot";
let decoMode=null;

function save(){
  localStorage.setItem("money",money);
  localStorage.setItem("level",level);
  localStorage.setItem("xp",xp);
  localStorage.setItem("freeTiles",JSON.stringify(FREE_TILES));
  localStorage.setItem("tiles",JSON.stringify(tiles));
  localStorage.setItem("penguinPos",penguinPos);
  localStorage.setItem("inventory",JSON.stringify(inventory));
  localStorage.setItem("decorations",JSON.stringify(decorationsPlaced));
  localStorage.setItem("dogs",dogs);
  localStorage.setItem("vehicle",vehicle);
  localStorage.setItem("zone",currentZone);
}

function updateUI(){
  moneyEl.textContent="ğŸ’° "+money;
  levelEl.textContent="â­ Lv "+level;
}

function getGrowBonus(){
  let b=1;
  if(dogs>0)b-=0.1;
  if(vehicle==="snowmobile")b-=0.1;
  return b;
}

function drawFarm(){
  farm.innerHTML="";
  for(let i=0;i<GRID*GRID;i++){
    const t=document.createElement("div");
    t.className="tile";

    if(!FREE_TILES.includes(i)){
      t.classList.add("frozen");
      t.textContent="â„ï¸";
      t.onclick=()=>breakIce(i);
      farm.appendChild(t);
      continue;
    }

    t.classList.add("free");

    if(decorationsPlaced[i]){
      t.textContent=decorationsPlaced[i];
      farm.appendChild(t);
      continue;
    }

    const isPenguin=penguinPos===i;

    if(!tiles[i]){
      t.textContent=isPenguin?"ğŸ§":"";
      t.onclick=()=>plant(i);
    } else {
      const c=crops[tiles[i].type];
      let elapsed=Date.now()-tiles[i].plantedAt;
      let grow=c.time*getGrowBonus();
      let ready=elapsed>=grow;
      t.textContent=c.emoji+(ready?"":" â³")+(isPenguin?" ğŸ§":"");
      t.onclick=ready?()=>harvest(i):()=>movePenguin(i);
    }
    farm.appendChild(t);
  }
}

function plant(i){
  if(decoMode){
    const d=decorations[decoMode];
    if(money<d.cost)return;
    money-=d.cost;
    decorationsPlaced[i]=d.emoji;
    decoMode=null;
    save();updateUI();drawFarm();
    return;
  }
  const c=crops[selectedCrop];
  if(money<c.cost||tiles[i])return;
  money-=c.cost;
  tiles[i]={type:selectedCrop,plantedAt:Date.now()};
  save();updateUI();drawFarm();
}

function harvest(i){
  const c=crops[tiles[i].type];
  money+=c.profit;
  inventory[c.emoji]=(inventory[c.emoji]||0)+1;
  xp+=c.xp;
  if(xp>=level*100){xp=0;level++;}
  delete tiles[i];
  save();updateUI();drawFarm();
}

function movePenguin(i){penguinPos=i;save();drawFarm();}
function breakIce(i){if(money<20)return;money-=20;FREE_TILES.push(i);save();updateUI();drawFarm();}
function selectCrop(t){selectedCrop=t;decoMode=null;}
function selectDeco(d){decoMode=d;selectedCrop=null;}

function goTo(z){
  currentZone=z;
  document.getElementById("farmView").classList.add("hidden");
  document.getElementById("mapView").classList.add("hidden");
  document.getElementById("cityView").classList.add("hidden");
  document.getElementById(z+"View").classList.remove("hidden");
  document.getElementById("zone").textContent="ğŸ“ "+(z==="farm"?"Ferma":z==="map"?"Harta":"OraÈ™");
  save();
}

function buyDog(){if(money<50)return;money-=50;dogs++;save();updateUI();}
function buySnowmobile(){if(money<100)return;money-=100;vehicle="snowmobile";save();updateUI();}

function openMarket(){
  const inv=document.getElementById("inventory");
  inv.innerHTML="";
  for(let k in inventory){
    const d=document.createElement("div");
    d.textContent=k+" x"+inventory[k];
    inv.appendChild(d);
  }
  document.getElementById("market").classList.remove("hidden");
}
function closeMarket(){document.getElementById("market").classList.add("hidden");}

const quests=[
  {text:"RecolteazÄƒ 3 morcovi",reward:20,done:false},
  {text:"CÃ¢È™tigÄƒ 50 monede",reward:30,done:false}
];

function openQuests(){
  const q=document.getElementById("questList");
  q.innerHTML="";
  quests.forEach(x=>{
    const d=document.createElement("div");
    d.textContent=x.text+(x.done?" âœ”":"");
    const b=document.createElement("button");
    b.textContent="FinalizeazÄƒ";
    b.disabled=x.done;
    b.onclick=()=>{x.done=true;money+=x.reward;save();updateUI();openQuests();}
    d.appendChild(b);
    q.appendChild(d);
  });
  document.getElementById("quests").classList.remove("hidden");
}
function closeQuests(){document.getElementById("quests").classList.add("hidden");}

updateUI();
goTo(currentZone);
setInterval(drawFarm,1000);
drawFarm();
</script>

</body>
</html>
